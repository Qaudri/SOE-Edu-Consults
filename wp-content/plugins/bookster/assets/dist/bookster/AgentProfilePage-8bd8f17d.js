import{r as e,d as a,_ as t,R as r,b as o,L as l,f as s,c as n}from"./prefetch.helper-04349684.js";import{a as m}from"./UIComponents-7ff4460b.js";import{H as i,B as c,D as b}from"./useCacheCustomers-102bfcf8.js";import{a as w,u}from"./page-agent.js";import{S as d}from"./Settings.styled-aa4d422d.js";import{b as p}from"./BEConfigProvider-705eafe2.js";import{v as f}from"./phoneInput.helper-806287af.js";import{l as _}from"./lodash-f550b173.js";import"./createBookTimeInput.helper-ed47ae63.js";import"./appointment.helper-07645f99.js";import"./BackendRouteErrorElement-6f34d3c9.js";function E(){const m=w(),[E,g]=e.useState(""),h=u((e=>e.profile.isLoading)),v=u((e=>e.saveAgentProfile)),k=p("upload_files"),[N]=a.Form.useForm(),{toast:x}=t.useToast();return e.useEffect((()=>{g((null==m?void 0:m.transient_avatar_url)??"")}),[]),r.createElement("div",{className:"bw-relative bw-mx-auto bw-max-w-screen-md bw-pt-4"},r.createElement("h4",{className:"bw-mb-2 bw-text-2xl bw-font-semibold"},o.sprintf(o.__("%(agent)s Profile","bookster"),l)),r.createElement("p",{className:"bw-mb-6 bw-text-sm bw-text-gray-500"},o.__("You can change your personal information here. ","bookster"),o.sprintf(o.__("%(customers)s will see this information when they contact you.","bookster"),l)),r.createElement(a.Form,{form:N,initialValues:m??{},onFinish:e=>{!async function(e){try{await v(m.agent_id,_.pick(e,["first_name","last_name","avatar_id","phone","bio"])),x.success("Profile has been Saved Successfully!")}catch(a){x.error(await n.getErrorMsg(a))}}(e)},scrollToFirstError:!0,layout:"vertical"},r.createElement("div",{className:"bw-mb-6 bw-rounded-md bw-bg-white bw-p-5 bw-shadow-sm"},r.createElement(t.LoadingOverlay,{loading:h}),r.createElement(i,{className:"bw-mb-6"},r.createElement(c,null),o.__("Profile","bookster")),r.createElement("div",{className:"bw-mb-5 bw-flex bw-items-center bw-gap-5"},r.createElement(t.Avatar,{className:"bw-h-20 bw-w-20 bw-items-center bw-justify-center bw-border-[3px] bw-border-solid bw-border-primary/20"},r.createElement(t.AvatarImage,{className:"bw-h-full bw-w-full bw-rounded-full bw-object-cover",src:E}),r.createElement(t.AvatarFallback,{className:"avatar-fallback bw-bg-inherit"},r.createElement(b,{className:"bw-h-20 bw-w-20"}))),k&&r.createElement("div",{className:"bw-flex bw-flex-wrap bw-items-center bw-gap-4"},r.createElement(t.Button,{size:"small",variant:"outline",color:"base",onClick:()=>{if(!k)return!1;const e=window.wp.media.frames.downloadable_file=window.wp.media({title:"Choose an image",multiple:!1});e.on("select",(function(){const a=e.state().get("selection").first().toJSON(),t=a.sizes.thumbnail||a.sizes.full;N.setFieldValue("avatar_id",+a.id),g(t.url)})),e.open()},className:"bw-rounded-sm bw-border-gray-100 bw-bg-gray-50 hover:bw-border-gray-100 hover:bw-text-primary"},o.__("Change Photo","bookster")),r.createElement("span",{className:"bw-cursor-pointer bw-text-xs bw-underline",onClick:()=>{N.setFieldValue("avatar_id",null),g("")}},o.__("Remove","bookster")),r.createElement("p",{className:"bw-w-full bw-text-sm bw-text-gray-500"},o.__("Upload a 256x256 Jpeg or Png (max 2MB)","bookster")))),r.createElement(a.Form.Item,{name:"avatar_id",hidden:!0},r.createElement("input",null)),r.createElement(t.Separator,{className:"bw-my-6"}),r.createElement("div",{className:"bw-grid bw-grid-cols-1 bw-gap-x-4 sm:bw-grid-cols-2"},r.createElement(a.Form.Item,{label:o.__("First Name","bookster"),name:"first_name",rules:[{required:!0}]},r.createElement(t.Input,{placeholder:o.__("Please enter First Name","bookster"),autoFocus:!0})),r.createElement(a.Form.Item,{label:o.__("Last Name","bookster"),name:"last_name",rules:[{required:!0}]},r.createElement(t.Input,{placeholder:o.__("Please enter Last Name","bookster")})),r.createElement(a.Form.Item,{label:o.__("Phone","bookster"),name:"phone",rules:[{required:!0},{validator:f,validateTrigger:"onBlur"}],validateTrigger:["onBlur","onChange"]},r.createElement(t.PhoneInput,null)),r.createElement(a.Form.Item,{label:o.__("Email","bookster"),name:"email"},r.createElement(t.Input,{disabled:!0})),r.createElement(a.Form.Item,{name:"bio",className:"bw-col-span-2",label:o.__("Bio","bookster")},r.createElement(t.Textarea,{rows:3,placeholder:o.__("Bio","bookster"),autoFocus:!0}))),s.booksterHooks.applyFilters(s.HOOK_NAMES.agentProfileForm.EndForm,[],m)),r.createElement(d,null)))}function g(){return r.createElement(m,null,r.createElement(E,null))}export{g as default};
