import{_ as e,c as a,r as t,f as r,R as s,b as l,L as n,d as o}from"./prefetch.helper-04349684.js";import{u as i}from"./store-bdc614dc.js";import{f as m}from"./CoverPicker-52693ec5.js";import{u as c}from"./BEConfigProvider-705eafe2.js";import{u}from"./useServiceFormContext-43091331.js";import{g as b,S as v,a as d,p as E}from"./ServiceGeneralTab-007b1fbe.js";import"./color.helper-9b8c6bb8.js";function f(){const{presetValues:f}=i((e=>e.services.form)),g=i((e=>e.resetServiceForm)),{toast:p}=e.useToast(),w=c(),{form:y}=u(),_=a.useQueryClient(),C=a.useMutation({mutationKey:["services","new"],mutationFn:m,onSuccess:e=>{_.setQueryData(["service",e.service_id],e),_.invalidateQueries({queryKey:["services"]})}}),k=a.useActiveAgents(),F=t.useMemo((()=>{let e=b(k);return f&&(e={...e,...f}),r.booksterHooks.applyFilters(r.HOOK_NAMES.adminServiceForm.initFormValues,e,void 0)}),[f,k]);return t.useEffect((()=>{y.resetFields(),y.setFieldsValue(F)}),[F]),s.createElement(s.Fragment,null,s.createElement(e.DrawerHeader,null,s.createElement(e.DrawerTitle,null,l.sprintf(l.__("New %(service)s","bookster"),n)),s.createElement(e.DrawerCloseIcon,null)),s.createElement(e.DrawerBody,null,s.createElement(e.LoadingOverlay,{loading:C.isLoading}),s.createElement(o.Form,{form:y,initialValues:F,disabled:C.isLoading,layout:"vertical",scrollToFirstError:!0,onFinish:e=>{!async function(e){try{const a=E(e);await C.mutateAsync(a),l.sprintf(l.__("%(service)s has been Saved Successfully!","bookster"),n),w(".."),g()}catch(t){p.error(await a.getErrorMsg(t))}}(e)}},s.createElement(e.Tabs,{defaultValue:"general"},s.createElement(e.TabsList,{"aria-label":"tabs settings",className:"-bw-mt-1"},s.createElement(e.CompactLineTabsTrigger,{value:"general"},l.__("General","bookster")),s.createElement(e.CompactLineTabsTrigger,{value:"available"},l.__("Available","bookster"))),s.createElement(e.TabsContent,{value:"general"},s.createElement(v,null)),s.createElement(e.TabsContent,{value:"available"},s.createElement(d,null))),s.createElement("button",{type:"submit",className:"bw-hidden"}))),s.createElement(e.DrawerFooter,null,s.createElement(e.DrawerClose,{asChild:!0},s.createElement(e.Button,{key:"back",tabIndex:-1,variant:"soft",size:"large",className:"bw-min-w-[7rem]"},l.__("Cancel","bookster"))),s.createElement(e.Button,{key:"submit",disabled:C.isLoading,size:"large",className:"bw-min-w-[7rem]",onClick:()=>y.submit()},l.__("Save","bookster"))))}export{f as default};
