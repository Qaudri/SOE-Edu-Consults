var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var o=booksterModules.utils,a=React;const r=t(a);var s=ReactDOM,n=booksterModules.hooks,i=booksterModules.components,d=booksterModules.icons;const c=i.stylex.div("bw-px-8 bw-py-12"),u=i.stylex.div("bw-mb-6 bw-text-center bw-text-6xl bw-text-primary"),l=i.stylex.h3("bw-mb-2 bw-text-center bw-text-2xl"),f=i.stylex.p("bw-mb-4 bw-text-center bw-text-base bw-text-gray-500"),y=i.stylex.div("bw-flex bw-justify-center bw-gap-2");var p=wp.i18n,m=booksterModules.antd;const b=document.createElement("div");b.classList.add("bookster-root"),document.body.appendChild(b);const{defaultAlgorithm:w,defaultSeed:g}=m.theme,M=w({...g,colorTextBase:"#1f2937",colorPrimary:"#3760F7",colorInfo:"#3760F7",colorSuccess:"#22c55e",colorWarning:"#eab308",colorError:"#f43f5e",fontFamily:"var(--btr-fontf-body)",fontSize:16,borderRadius:8}),h={prefixCls:"bant",direction:window.booksterMeta.meta.isRtl?"rtl":"ltr",form:{validateMessages:{required:"Please enter ${label}!",max:"Maximum ${max} characters!",types:{email:"Please enter a valid Email!"}}},theme:{token:M},getPopupContainer:()=>b},_={theme:{token:{...M,fontSize:14}}};async function k(e){if(0!==await o.api.patch("auth/wp-user/email-exists",{json:{email:e}}).json())throw new Error("Email already exist!")}const v=o.createStore()(o.immer(o.devtools(((e,t)=>({isLoading:!1,wpUserInfo:window.booksterMeta.auth.wpUserInfo,customerRecord:window.booksterMeta.auth.customerRecord,agentRecord:window.booksterMeta.auth.agentRecord,login:async a=>{if(!t().isLoading){e((e=>{e.isLoading=!0}));try{const t=await async function(e){const t=await o.api.patch("auth/login",{json:e}).json();return await o.updateRestNonce(),t}(a);e((e=>{e.wpUserInfo=t.wpUserInfo,e.customerRecord=t.customerRecord,e.agentRecord=t.agentRecord}))}finally{e((e=>{e.isLoading=!1}))}}},logout:async()=>{if(!t().isLoading){e((e=>{e.isLoading=!0}));try{await async function(){await o.api.patch("auth/logout").json(),await o.updateRestNonce()}(),e((e=>{e.wpUserInfo={isLoggedIn:!1,avatarUrl:void 0,firstName:void 0,lastName:void 0,displayName:void 0,email:void 0,role:void 0,caps:void 0},e.customerRecord=null,e.agentRecord=null}))}finally{e((e=>{e.isLoading=!1}))}}},updateCustomerRecord:t=>{e((e=>{e.customerRecord=t}))},updateAgentRecord:t=>{e((e=>{e.agentRecord=t}))}})))));n.booksterHooks.addAction(n.HOOK_NAMES.auth.doUpdateAgentRecord,"bookster/authStore",(e=>{v.getState().updateAgentRecord(e)})),n.booksterHooks.addAction(n.HOOK_NAMES.auth.doUpdateCustomerRecord,"bookster/authStore",(e=>{v.getState().updateCustomerRecord(e)}));const x=window.booksterMeta.recordLabels;function A(e){switch(e){case"unpaid":return p.__("Unpaid","bookster");case"refunded":return p.__("Refunded","bookster");case"complete":return p.__("Completed","bookster");default:return p.__("Incomplete","bookster")}}function R(e){switch(e){case"approved":return p.__("Approved","bookster");case"canceled":return p.__("Canceled","bookster");default:return p.__("Pending Approval","bookster")}}function O(e){switch(e){case"approved":return p.__("Approved","bookster");case"canceled":return p.__("Canceled","bookster");default:return p.__("Pending","bookster")}}var T=booksterModules.day,S=booksterModules.decimal;const D=[1,2,3,4,5,6,0];function Y(e){const t=structuredClone(e);for(const o of D)t[o].periods=t[o].periods.sort(((e,t)=>e.start.absMinute-t.start.absMinute));return t}function E(e){const t=structuredClone(e);for(const o in e)0===Object.keys(e[o]).length&&delete t[o];return 0===Object.keys(t).length?null:t}const B=window.booksterPublicData.generalSettings.time_slot_step;function C(){const e=B%60;return 0===e?60:e>0&&e<=30?e:e>30&&e<60?e%30:5}function j(e){const t=T.dayjs(),o=t.add(1,"day");if("resourceTimelineDay"===e){const e=t.utc(!0).startOf("day").toDate(),a=o.utc(!0).startOf("day").toDate();return{type:"resourceTimelineDay",title:t.format("MMMM D, YYYY"),activeStart:e,activeEnd:a}}if("timeGridWeek"===e){const e=t.startOf("week"),o=t.endOf("week"),a=e.utc(!0).startOf("day").toDate(),r=o.add(1,"day").utc(!0).startOf("day").toDate();return{type:"timeGridWeek",title:e.format(`MMMM D - [${o.date()}], YYYY`),activeStart:a,activeEnd:r}}{const e=t.startOf("month"),o=t.endOf("month"),a=e.utc(!0).startOf("day").toDate(),r=o.add(1,"day").utc(!0).startOf("day").toDate();return{type:"dayGridMonth",title:e.format("MMMM YYYY"),activeStart:a,activeEnd:r}}}const I=i.styled.a("bw-text-info hover:bw-text-info/60"),P=i.styled.a("bw-text-gray-800 hover:bw-text-gray-800/60");async function F(e,t){let a;const r=t.startOf("month");return a=r.isBefore(T.dayjs())?T.dayjs().startOf("day").format(T.DB_TIMESTAMP_FORMAT):r.format(T.DB_TIMESTAMP_FORMAT),await o.getBookedAppointmentsByAgent({datetime_min:a,datetime_max:t.endOf("month").format(T.DB_TIMESTAMP_FORMAT),agent_ids:[e.agent_id]})}async function q(e){let t;const a=e.startOf("month");return t=a.isBefore(T.dayjs())?T.dayjs().startOf("day").format(T.DB_TIMESTAMP_FORMAT):a.format(T.DB_TIMESTAMP_FORMAT),await o.getBookedAppointmentsByUser({datetime_min:t,datetime_max:e.endOf("month").format(T.DB_TIMESTAMP_FORMAT)})}function L(e,t){return o.queryClient.prefetchQuery({queryKey:["bookedApptsByAgent",e.agent_id,t.format("YYYY-MM")],queryFn:()=>F(e,t),staleTime:6e4})}function U(e){return o.queryClient.prefetchQuery({queryKey:["bookedApptsByUser",e.format("YYYY-MM")],queryFn:()=>q(e),staleTime:6e4})}function N(){o.prefetchAgents(),o.prefetchServices()}async function H(e){try{o.queryClient.getQueryData(["services","group_by_category"])||o.prefetchServices();let t=o.queryClient.getQueryData(["agents"]);t||(t=await o.fetchAgents(),o.queryClient.setQueryData(["agents"],t)),U(e),await async function(e,t){for(const o of e)o.activated&&"public"===o.visibility&&await L(o,t)}(t,e)}catch(t){console.error("Error prefetch BookingForm",t)}}export{H as A,E as B,F as C,q as D,L as E,U as F,k as G,e as H,O as I,x as L,r as R,B as T,D as W,i as _,d as a,p as b,o as c,m as d,I as e,n as f,T as g,R as h,s as i,j,t as k,c as l,u as m,l as n,f as o,N as p,y as q,a as r,S as s,P as t,v as u,A as v,C as w,Y as x,_ as y,h as z};
